<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood"
       version="2.0">
    <!-- SRD06 model: split sequences in first together with seconds and thirds of all sites -->
    <data id="alignment" dataType="nucleotide">
        <sequence taxon="human">
            AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGCTTAAACCCCCTTATTTCTACTAGGACTATGAGAATCGAACCCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTATACCCTTCCCGTACTAAGAAATTTAGGTTAAATACAGACCAAGAGCCTTCAAAGCCCTCAGTAAGTTG-CAATACTTAATTTCTGTAAGGACTGCAAAACCCCACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGACCAATGGGACTTAAACCCACAAACACTTAGTTAACAGCTAAGCACCCTAATCAAC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTCGAATTTGCAATTCAATATGAAAA-TCACCTCGGAGCTTGGTAAAAAGAGGCCTAACCCCTGTCTTTAGATTTACAGTCCAATGCTTCA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCCAAAGCTGGTTTCAAGCCAACCCCATGGCCTCCATGACTTTTTCAAAAGGTATTAGAAAAACCATTTCATAACTTTGTCAAAGTTAAATTATAGGCT-AAATCCTATATATCTTA-CACTGTAAAGCTAACTTAGCATTAACCTTTTAAGTTAAAGATTAAGAGAACCAACACCTCTTTACAGTGA
        </sequence>
        <sequence taxon="chimp">
            AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGTTCAAATCCCCTTATTTCTACTAGGACTATAAGAATCGAACTCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTACACCCTTCCCGTACTAAGAAATTTAGGTTAAGCACAGACCAAGAGCCTTCAAAGCCCTCAGCAAGTTA-CAATACTTAATTTCTGTAAGGACTGCAAAACCCCACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATTAATGGGACTTAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAATCAAC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTCGAATTTGCAATTCAATATGAAAA-TCACCTCAGAGCTTGGTAAAAAGAGGCTTAACCCCTGTCTTTAGATTTACAGTCCAATGCTTCA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCTAAAGCTGGTTTCAAGCCAACCCCATGACCTCCATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAAGTTAAATTACAGGTT-AACCCCCGTATATCTTA-CACTGTAAAGCTAACCTAGCATTAACCTTTTAAGTTAAAGATTAAGAGGACCGACACCTCTTTACAGTGA
        </sequence>
        <sequence taxon="bonobo">
            AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGTTTAAATCCCCTTATTTCTACTAGGACTATGAGAGTCGAACCCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTATACCCTTCCCGTACTAAGAAATTTAGGTTAAACACAGACCAAGAGCCTTCAAAGCTCTCAGTAAGTTA-CAATACTTAATTTCTGTAAGGACTGCAAAACCCCACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATTAATGGGACTTAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAATCAGC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTTGAATTTGCAATTCAATATGAAAA-TCACCTCAGAGCTTGGTAAAAAGAGGCTTAACCCCTGTCTTTAGATTTACAGTCCAATGCTTCA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCTAAAGCTGGTTTCAAGCCAACCCCATGACCCCCATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAAGTTAAATTACAGGTT-AAACCCCGTATATCTTA-CACTGTAAAGCTAACCTAGCATTAACCTTTTAAGTTAAAGATTAAGAGGACCAACACCTCTTTACAGTGA
        </sequence>
        <sequence taxon="gorilla">
            AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGTTTAAACCCCCTTATTTCTACTAGGACTATGAGAATTGAACCCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTGTCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTCACATCCTTCCCGTACTAAGAAATTTAGGTTAAACATAGACCAAGAGCCTTCAAAGCCCTTAGTAAGTTA-CAACACTTAATTTCTGTAAGGACTGCAAAACCCTACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATCAATGGGACTCAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAGTCAAC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTCGAATTTGCAATTCAATATGAAAT-TCACCTCGGAGCTTGGTAAAAAGAGGCCCAGCCTCTGTCTTTAGATTTACAGTCCAATGCCTTA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCCAAAGCTGGTTTCAAGCCAACCCCATGACCTTCATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAGGTTAAATTACGGGTT-AAACCCCGTATATCTTA-CACTGTAAAGCTAACCTAGCGTTAACCTTTTAAGTTAAAGATTAAGAGTATCGGCACCTCTTTGCAGTGA
        </sequence>
        <sequence taxon="orangutan">
            AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGTCTAAATCCCCTTATTTCTACTAGGACTATGGGAATTGAACCCACCCCTGAGAATCCAAAATTCTCCGTGCCACCCATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTACACCCTTCCCGTACTAAGAAATTTAGGTTA--CACAGACCAAGAGCCTTCAAAGCCCTCAGCAAGTCA-CAGCACTTAATTTCTGTAAGGACTGCAAAACCCCACTTTGCATCAACTGAGCGCAAATCAGCCACTTTAATTAAGCTAAGCCCTCCTAGACCGATGGGACTTAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAGTCAAT-TGGCTTCAGTCCAAAGCCCCGGCAGGCCTTAAAGCTGCTCCTTCGAATTTGCAATTCAACATGACAA-TCACCTCAGGGCTTGGTAAAAAGAGGTCTGACCCCTGTTCTTAGATTTACAGCCTAATGCCTTAACTCGGCCATTTTACCGCAAAAAAGGAAGGAATCGAACCTCCTAAAGCTGGTTTCAAGCCAACCCCATAACCCCCATGACTTTTTCAAAAGGTACTAGAAAAACCATTTCGTAACTTTGTCAAAGTTAAATTACAGGTC-AGACCCTGTGTATCTTA-CATTGCAAAGCTAACCTAGCATTAACCTTTTAAGTTAAAGACTAAGAGAACCAGCCTCTCTTTGCAATGA
        </sequence>
        <sequence taxon="siamang">
            AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGTTTAAATCCCCTTATTTCTACTAGAACCATAGGAGTCGAACCCATCCTTGAGAATCCAAAACTCTCCGTGCCACCCGTCGCACCCTGTTCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTATACCCTTCCCATACTAAGAAATTTAGGTTAAACACAGACCAAGAGCCTTCAAAGCCCTCAGTAAGTTAACAAAACTTAATTTCTGCAAGGGCTGCAAAACCCTACTTTGCATCAACCGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATCGATGGGACTTAAACCCATAAAAATTTAGTTAACAGCTAAACACCCTAAACAACCTGGCTTCAATCTAAAGCCCCGGCAGA-GTTGAAGCTGCTTCTTTGAACTTGCAATTCAACGTGAAAAATCACTTCGGAGCTTGGCAAAAAGAGGTTTCACCTCTGTCCTTAGATTTACAGTCTAATGCTTTA-CTCAGCCACTTTACCACAAAAAAGGAAGGAATCGAACCCTCTAAAACCGGTTTCAAGCCAGCCCCATAACCTTTATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAAGTTAAATCACAGGTCCAAACCCCGTATATCTTATCACTGTAGAGCTAGACCAGCATTAACCTTTTAAGTTAAAGACTAAGAGAACTACCGCCTCTTTACAGTGA
        </sequence>
    </data>

    <data data="@alignment" dataType="nucleotide" filter="1::3,2::3" id="CP12" name="taxa"
          spec="beast.evolution.alignment.FilteredAlignment"/>
    <data data="@alignment" dataType="nucleotide" filter="3::3" id="CP3" name="taxa"
          spec="beast.evolution.alignment.FilteredAlignment"/>

    <siteModel gammaCategoryCount="4" id="CP12.siteModel" spec="SiteModel">
        <parameter dimension="1" id="CP12.mutationRate" name="mutationRate" value="1.0" lower="0.0"/>
        <parameter dimension="1" id="CP12.gammaShape" name="shape" value="0.5" lower="0.0" upper="1000.0"/>
        <substModel id="CP12.hky" kappa="@CP12.hky.kappa" spec="HKY">
            <frequencies frequencies="@CP12.frequencies" id="CP12.freqs" spec="Frequencies"/>
        </substModel>
    </siteModel>

    <siteModel gammaCategoryCount="4" id="CP3.siteModel" spec="SiteModel">
        <parameter dimension="1" id="CP3.mutationRate" name="mutationRate" value="1.0" lower="0.0"/>
        <parameter dimension="1" id="CP3.gammaShape" name="shape" value="0.5" lower="0.0" upper="1000.0"/>
        <substModel id="CP3.hky" kappa="@CP3.hky.kappa" spec="HKY">
            <frequencies frequencies="@CP3.frequencies" id="CP3.freqs" spec="Frequencies"/>
        </substModel>
    </siteModel>

    <input spec='StrictClockModel' id="branchRates">
        <parameter name='clock.rate' id='clockRate' value="1.0"/>
    </input>

    <input spec='beast.util.ClusterTree' id='tree' clusterType='upgma'>
        <!--trait idref='rateCategories'/-->
        <taxa idref='alignment'/>
    </input>

    <input spec='TreeLikelihood' id="CP12.treeLikelihood">
        <data idref="alignment"/>
        <tree idref="tree"/>
        <siteModel idref="CP12.siteModel"/>
        <branchRateModel idref="branchRates"/>
    </input>

    <input spec='TreeLikelihood' id="CP3.treeLikelihood">
        <data idref="alignment"/>
        <tree idref="tree"/>
        <siteModel idref="CP3.siteModel"/>
        <branchRateModel idref="branchRates"/>
    </input>

    <parameter id="CP12.hky.kappa" value="2.0" lower="0.0"/>
    <parameter id="CP3.hky.kappa" value="2.0" lower="0.0"/>
    <parameter id="CP12.frequencies" value="0.25" dimension="4"/>
    <parameter id="CP3.frequencies" value="0.25" dimension="4"/>
    <parameter id="popSize" value="0.077" lower="0.0"/>

    <run spec="MCMC" id="mcmc" chainLength="10000000"> <!--autoOptimize="true"-->

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution spec="CompoundDistribution" id="prior">
                <distribution id="CP12.hky.kappa.prior" spec="beast.math.distributions.Prior" x="@CP12.hky.kappa">
                    <distr id="LogNormalDistributionModel" M="1.0" S="1.25" meanInRealSpace="false"
                           spec="beast.math.distributions.LogNormalDistributionModel"/>
                </distribution>
                <distribution id="CP12.hky.frequencies.prior" spec="beast.math.distributions.Prior" x="@CP12.frequencies">
                    <distr id="Uniform" lower="0.0" upper="1.0" spec="beast.math.distributions.Uniform"/>
                </distribution>
                <distribution id="CP3.hky.kappa.prior" spec="beast.math.distributions.Prior" x="@CP3.hky.kappa">
                    <distr id="LogNormalDistributionModel" M="1.0" S="1.25" meanInRealSpace="false"
                           spec="beast.math.distributions.LogNormalDistributionModel"/>
                </distribution>
                <distribution id="CP3.hky.frequencies.prior" spec="beast.math.distributions.Prior" x="@CP3.frequencies">
                    <distr id="Uniform" lower="0.0" upper="1.0" spec="beast.math.distributions.Uniform"/>
                </distribution>
                <distribution id="popSize.prior" spec="beast.math.distributions.Prior" x="@popSize">
                    <distr id="OneOnX" offset="0.0" spec="beast.math.distributions.OneOnX"/>
                </distribution>

                <distribution id="coalescent" spec="Coalescent">
                    <treeIntervals spec='TreeIntervals' id='TreeIntervals'>
                        <tree idref="tree"/>
                    </treeIntervals>
                    <populationModel spec="ConstantPopulation">
                        <popSize idref="popSize"/>
                    </populationModel>
                </distribution>
            </distribution>
            <distribution spec="CompoundDistribution" id='likelihood'>
                <distribution idref="CP12.treeLikelihood"/>
                <distribution idref="CP3.treeLikelihood"/>
            </distribution>
        </distribution>

        <operator id='CP12kappaScaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@CP12.hky.kappa"/>
        <operator id='CP12frequenciesDelta' spec='DeltaExchangeOperator' delta="0.01" weight="0.1"
                  parameter="@CP12.frequencies"/>
        <operator id='CP3kappaScaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@CP3.hky.kappa"/>
        <operator id='CP3frequenciesDelta' spec='DeltaExchangeOperator' delta="0.01" weight="0.1"
                  parameter="@CP3.frequencies"/>
        <operator id='CP12alphaScaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@CP12.gammaShape"/>
        <operator id='CP3alphaScaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@CP3.gammaShape"/>
        <operator id='popSizeScaler' spec='ScaleOperator' scaleFactor="0.75" weight="3" parameter="@popSize"/>
        <operator id='treeScaler' spec='ScaleOperator' scaleFactor="0.75" weight="3" tree="@tree"/>
        <operator spec='Uniform' weight="30" tree="@tree"/>
        <operator spec='SubtreeSlide' weight="15" gaussian="true" size="0.0077" tree="@tree"/>
        <operator id='narrow' spec='Exchange' isNarrow='true' weight="15" tree="@tree"/>
        <operator id='wide' spec='Exchange' isNarrow='false' weight="3" tree="@tree"/>
        <operator spec='WilsonBalding' weight="1" tree="@tree"/>
        <operator spec='UpDownOperator' scaleFactor="0.75" weight="3" down="@tree"/>

        <logger logEvery="1000" fileName="test.$(seed).log">
            <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="prior"/>
            <log idref="likelihood"/>
            <log spec='beast.evolution.tree.TreeHeightLogger' tree='@tree'/>
            <log idref="popSize"/>
            <log idref="CP12.hky.kappa"/>
            <log idref="CP3.hky.kappa"/>
            <log idref="CP12.frequencies"/>
            <log idref="CP3.frequencies"/>
            <log idref="CP12.gammaShape"/>
            <log idref="CP3.gammaShape"/>
            <log idref="CP12.mutationRate"/>
            <log idref="CP3.mutationRate"/>
            <log idref="clockRate"/>
            <log idref="CP12.treeLikelihood"/>
            <log idref="CP3.treeLikelihood"/>
            <log idref="coalescent"/>
        </logger>
        <!--         <logger logEvery="1000" fileName="test.$(seed).trees">
    <log idref="tree"/>
</logger>        -->
        <logger logEvery="100000">
            <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="prior"/>
            <log idref="likelihood"/>
            <log spec='beast.evolution.tree.TreeHeightLogger' tree='@tree'/>
            <log idref="popSize"/>
            <log idref="coalescent"/>
        </logger>
    </run>

</beast>
